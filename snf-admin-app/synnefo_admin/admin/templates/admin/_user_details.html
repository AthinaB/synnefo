{% load admin_tags %}

{% with user=item %}
<div class="object-anchor" id="user-{{user.uuid}}"></div>
<div class="object-details {{ rowcls }}" data-id="{{user.uuid}}"
    data-type="{{type}}">
    <h4>
        <a href="{% url admin-details type user.uuid %}" class="snf-font-admin snf-search icon-link" title="Details for {{ user|repr }}"></a>
        <span class="title">{{ user|repr }}</span>
        <span class="arrow snf-font-admin snf-angle-down"></span>
        <span class="label">{{ user.status_display|upper }}</span>
        <span class="label">UUID: {{ user.uuid }}</span>
        <span class="label">{{ user.email }}</span>
    </h4>

    <div class="object-details-content">
        <ul class="nav nav-tabs">
            <li class="active"><a href="#details{{ user.uuid }}" data-toggle="tab">Details</a></li>
            <li><a href="#log{{ user.uuid }}" data-toggle="tab">Log</a></li>
            <li><a href="#auth{{ user.uuid }}" data-toggle="tab">Auth Providers</a></li>
        </ul>
        <div class="tab-content">
            <div class="tab-pane active" id="details{{ user.uuid }}">
                <dl class="dl-horizontal well">
                    <dt>UUID</dt><dd>{{ user.uuid }}</dd>
                    <dt>Name</dt><dd>{{ user.realname }}</dd>
                    <dt>Groups</dt><dd>{{ user|get_groups }}</dd>
                </dl>
            </div>
            <div class="tab-pane" id="log{{ user.uuid }}">
                <dl class="dl-horizontal well">
                    {% if user.date_signed_terms %}
                        <dt>Signed terms at</dt><dd>{{ user.date_signed_terms }}</dd>
                    {% endif %}
                    {% if user.verified_at %}
                        <dt>Verified at</dt><dd>{{ user.verified_at }}</dd>
                    {% endif %}
                    {% if user.activation_sent %}
                        <dt>Activation sent at</dt><dd>{{ user.activation_sent }}</dd>
                    {% endif %}
                    {% if user.moderated_at %}
                        <dt>Moderated at</dt><dd>{{ user.moderated_at }}</dd>
                        <dt>Moderation policy</dt><dd>{{ user.accepted_policy }}</dd>
                    {% endif %}
                    {% if user.rejected_reason %}
                        <dt>Rejection reason</dt><dd>{{ user.rejected_reason }}</dd>
                    {% endif %}
                    {% if user.deactivated_at %}
                        <dt>Deactivated at</dt><dd>{{ user.deactivated_at }}</dd>
                        <dt>Deactivation reason</dt><dd>{{ user.deactivated_reason }}</dd>
                    {% endif %}

                    <dt>---</dt><dd>------------------</dd>

                    <dt>Last profile update at</dt><dd>{{ user.updated }}</dd>
                    <dt>Last logged-in at</dt><dd>{{ user.last_login }}</dd>

                </dl>
            </div>
            <div class="tab-pane" id="auth{{ user.uuid }}">
                <dl class="dl-horizontal well">
                    <dt>Unused</dt><dd>
                        {% for ap in user.get_available_auth_providers %}
                            {{ ap.module }},
                        {% empty %}
                            None
                        {% endfor %}
                    </dd>
                    <dt>Enabled</dt><dd>
                        {% for ap in user.get_enabled_auth_providers %}
                            {{ ap.module }},
                        {% empty %}
                            None
                        {% endfor %}
                    <dt>Disabled</dt><dd>
                        {% for ap in user.get_disabled_auth_providers %}
                            {{ ap.module }},
                        {% empty %}
                            None
                        {% endfor %}
                    </dd>
                </dl>
            </div>
        </div> <!-- <div class="tab-content"> -->
    </div> <!-- <div class="object-details-content"> -->
    {% include "admin/action_list_horizontal.html" %}
</div> <!-- <div class="object-details {{ rowcls }}"> -->
{% endwith %}
